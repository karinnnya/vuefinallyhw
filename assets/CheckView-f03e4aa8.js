import{d as S,r as T,c as I,l as $,s as F,F as P,a as B,E as R,z as E}from"./zh_TW-d95d40c7.js";import{S as U}from"./sweetalert2.all-4df3b2fe.js";import{T as z}from"./TitleComponent-2e52f0f4.js";import{ba as y,ak as i,m as a,n as e,bb as O,aw as d,u as r,F as q,au as A,aK as l,b2 as D,t as v,a4 as h}from"./_plugin-vue_export-helper-bc03d341.js";import{c as k}from"./cartStore-eef63568.js";import{a as N,m as M}from"./pinia-9491ed26.js";import"./produceStore-727c8f72.js";const W=""+new URL("progress3-883137a1.png",import.meta.url).href;const K={methods:{progress50(){this.$refs.progress.classList.add("width50"),this.$refs.progimg.classList.add("start-50")},progress100(){this.$refs.progress.classList.add("width100"),this.$refs.progimg.classList.add("start-100")}}},j={class:"position-relative d-none d-md-block mb-5 mt-5"},G={class:"progress-bar"},H={class:"progress",ref:"progress"},J={class:"position-absolute top-0 start-0 progimg",ref:"progimg"},Q=e("img",{src:W,style:{width:"100px"},class:"progimg",alt:""},null,-1),X=[Q];function Y(c,s,m,x,o,p){return i(),a("div",j,[e("div",G,[e("div",H,null,512)]),e("div",J,X,512)])}const Z=y(K,[["render",Y]]);S("required",T);I({generateMessage:$({zh_TW:E}),validateOnInput:!0});F("zh_TW");const{VITE_APP_URL:ee}={VITE_APP_URL:"https://vuefinallysever.onrender.com",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0},te={data(){return{isLoading:!1,recipientCheck:!1,checkOk:!1,recipient:{name:"",tel:"",address:""}}},components:{Form:P,TitleComponent:z,ProgressComponent:Z,Field:B,ErrorMessage:R},computed:{...N(k,["cartList","total"])},methods:{...M(k,["getCart","delCartAll"]),setCheck(){this.checkOk=!0,this.$nextTick(()=>{this.$refs.progressBarRef.progress100()});let c=this.cartList.carts,s=new Date().getTime();O.post(`${ee}/productOrders`,{id:s,checkTime:new Date().toLocaleString(),userId:this.userId,recipient:this.recipient,data:c,total:this.total,Status:"已付款"}).then(()=>{this.delCartAll(this.userId)}).catch(m=>{U.fire(m)})},onSubmit(){this.recipientCheck=!0,this.$nextTick(()=>{this.$refs.progressBarRef.progress50()})},isPhone(c){return/^(09)[0-9]{8}$/.test(c)?!0:"需為正確的電話號碼"}},mounted(){this.userId=localStorage.getItem("userId")}},se={class:"container pt-5"},oe={key:0,class:"row"},re={class:"col-12 col-md-7"},ne={class:"table align-middle"},le=e("thead",{class:"bg-secondary text-white"},[e("tr",null,[e("th",{width:"120"},"圖片"),e("th",{width:"200"},"商品"),e("th",{width:"120"},"單價"),e("th",{width:"150"},"數量"),e("th",{width:"150"},"小計")])],-1),ie=["src"],ae={class:"text-end"},ce={class:"col-12 col-md-4 offset-md-1"},de={class:"userForm border-secondary border border-4"},pe=e("h5",{class:"bg-secondary text-white p-3"},"收件者資料",-1),me={class:"p-3"},ue={key:0},_e=e("label",{for:"phone",class:"form-label"},"姓名",-1),he=e("label",{for:"phone",class:"form-label"},"電話",-1),fe=e("label",{for:"address",class:"form-label"},"收件地址",-1),ge=e("button",{type:"onSubmit",class:"btn btn-secondary text-white mt-3"}," 建立訂單 ",-1),be={key:1},ve=e("p",null,null,-1),ke={key:1,class:"text-center text-secondary"},ye=e("h4",null,[v(" 已收到您的訂單 "),e("br"),v(" 非常感謝您 ")],-1);function xe(c,s,m,x,o,p){const w=d("TitleComponent"),C=d("ProgressComponent"),u=d("Field"),_=d("error-message"),V=d("Form"),L=d("BootstrapIcon");return i(),a("div",se,[r(w,{title:"線上商城結帳",class:"text-center mt-5 mb-5"}),r(C,{ref:"progressBarRef"},null,512),o.checkOk?(i(),a("div",ke,[ye,r(L,{icon:"box-seam-fill",class:"me-1",size:"5x"})])):(i(),a("div",oe,[e("div",re,[e("table",ne,[le,e("tbody",null,[(i(!0),a(q,null,A(this.cartList.carts,t=>{var n,f,g,b;return i(),a("tr",{key:t.id},[e("td",null,[e("img",{src:(n=t.product)==null?void 0:n.imgUrls,class:"table-image",alt:"產品圖片",style:{width:"100px"}},null,8,ie)]),e("td",null,l((f=t.product)==null?void 0:f.title),1),e("td",null,l((g=t.product)==null?void 0:g.price),1),e("td",null,l(t.qty),1),e("td",null,l(t.qty*((b=t.product)==null?void 0:b.price)),1)])}),128))])]),e("p",ae,"總金額： "+l(c.total)+" 元",1)]),e("div",ce,[e("div",de,[pe,e("div",me,[o.recipientCheck?(i(),a("div",be,[e("p",null,"姓名： "+l(o.recipient.name),1),e("p",null,"電話： "+l(o.recipient.tel),1),e("p",null,"地址： "+l(o.recipient.tel),1),ve,e("button",{type:"onSubmit",class:"btn btn-secondary text-white mt-3",onClick:s[3]||(s[3]=(...t)=>p.setCheck&&p.setCheck(...t))}," 前往付款 ")])):(i(),a("div",ue,[r(V,{onSubmit:p.onSubmit},{default:D(({errors:t})=>[e("div",null,[_e,r(u,{id:"name",name:"姓名",type:"text",class:h(["form-control",{"is-invalid":t.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:o.recipient.name,"onUpdate:modelValue":s[0]||(s[0]=n=>o.recipient.name=n)},null,8,["modelValue","class"]),r(_,{name:"姓名",class:"invalid-feedback"})]),e("div",null,[he,r(u,{id:"phone",name:"電話",type:"text",class:h(["form-control",{"is-invalid":t.電話}]),placeholder:"請輸入電話",modelValue:o.recipient.tel,"onUpdate:modelValue":s[1]||(s[1]=n=>o.recipient.tel=n),rules:p.isPhone},null,8,["class","modelValue","rules"]),r(_,{name:"電話",class:"invalid-feedback"})]),e("div",null,[fe,r(u,{id:"address",name:"地址",type:"address",class:h(["form-control",{"is-invalid":t.地址}]),placeholder:"請輸入地址",modelValue:o.recipient.address,"onUpdate:modelValue":s[2]||(s[2]=n=>o.recipient.address=n),rules:"required"},null,8,["modelValue","class"]),r(_,{name:"地址",class:"invalid-feedback"})]),ge]),_:1},8,["onSubmit"])]))])])])]))])}const $e=y(te,[["render",xe]]);export{$e as default};
