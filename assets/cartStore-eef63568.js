import{p as h}from"./produceStore-727c8f72.js";import{bb as i}from"./_plugin-vue_export-helper-bc03d341.js";import{S as s}from"./sweetalert2.all-4df3b2fe.js";import{d as p}from"./pinia-9491ed26.js";const{VITE_APP_URL:c}={VITE_APP_URL:"https://vuefinallysever.onrender.com",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0},u=s.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:1e3,timerProgressBar:!0,didOpen:t=>{t.addEventListener("mouseenter",s.stopTimer),t.addEventListener("mouseleave",s.resumeTimer)}}),g=p("cart",{state:()=>({cart:[],loading:"",products:[],check:[]}),actions:{getCart(t){if(t)return i.get(`${c}/cart/${t}`).then(r=>{this.cart=r.data.data}).catch(r=>{s.fire(r),i.post(`${c}/cart`,{id:t,userId:t,data:[]}).then(()=>{}).catch(e=>{s.fire(e),this.getCart()})})},addToCart(t,r,e=1){const a=this.cart.find(o=>o.productId===r);if(u.fire({icon:"success",title:"成功加入購物車",iconColor:"#88D1F5"}),a)a.qty+=e,this.upCart(t);else{const n={id:this.cart.length+1,productId:r,qty:e};this.cart.push(n),this.upCart(t)}},delCart(t,r){const e=this.cart.findIndex(a=>a.id===r);this.cart.splice(e,1),this.upCart(t)},setCartQty(t,r){this.loading=r.id;const e=this.cart.find(a=>a.productId===r.productId);e.qty=r.qty,this.upCart(t)},upCart(t){i.patch(`${c}/cart/${t}`,{data:this.cart}).then(()=>{this.loading=""}).catch(r=>{s.fire(r)})},delCartAll(t){this.cartList.carts=[],i.patch(`${c}/cart/${t}`,{data:this.cartList.carts}).then(()=>{}).catch(r=>{s.fire(r)})},checkCart(t,r){this.check=JSON.parse(JSON.stringify(t)),this.total=r}},getters:{cartList:({cart:t})=>{if(t!==void 0){const{products:r}=h();return{carts:t.map(a=>{let n=r.filter(d=>d.id===a.productId)[0];return{...a,product:n}})}}}}});export{g as c};
